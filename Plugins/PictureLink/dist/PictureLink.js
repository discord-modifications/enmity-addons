function b(n){window.enmity.plugins.registerPlugin(n)}const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList,e.Image,e.ImageBackground,e.KeyboardAvoidingView,e.Modal;const y=e.Pressable;e.RefreshControl,e.ScrollView,e.SectionList,e.StatusBar,e.StyleSheet,e.Switch,e.Text,e.TextInput,e.TouchableHighlight,e.TouchableOpacity,e.TouchableWithoutFeedback,e.Touchable,e.View,e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox,e.FormDivider,e.FormHint,e.FormIcon,e.FormInput,e.FormLabel,e.FormRadio;const v=e.FormRow;e.FormSection,e.FormSelect,e.FormSubLabel;const f=e.FormSwitch;e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;const p={byProps:(...n)=>window.enmity.modules.filters.byProps(...n),byName:(n,o)=>window.enmity.modules.filters.byName(n,o),byTypeName:(n,o)=>window.enmity.modules.filters.byTypeName(n,o),byDisplayName:(n,o)=>window.enmity.modules.filters.byDisplayName(n,o)};function S(...n){return window.enmity.modules.bulk(...n)}window.enmity.modules.common,window.enmity.modules.common.Constants,window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const s=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts;const h=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function F(n){return window.enmity.patcher.create(n)}function T(n,o,t){return window.enmity.settings.get(n,o,t)}var P=({settings:n})=>s.createElement(v,{label:"Long press to open profiles:",trailing:s.createElement(f,{value:n.get("longPressEnabled",!1),onValueChange:()=>n.toggle("longPressEnabled",!1)})});const c=F("picture-link"),[L,A,a,C]=S(n=>{var o;return((o=n.default)==null?void 0:o.name)==="ProfileBanner"},n=>{var o;return((o=n.default)==null?void 0:o.name)==="HeaderAvatar"},p.byProps("transitionToGuild"),p.byProps("getUser")),R={name:"PictureLink",version:"2.0.0",description:"Allows you to tap / hold on avatars and banners to open them in-app.",authors:[{name:"eternal",id:"263689920210534400"}],onStart(){c.after(A,"default",(n,[{user:o,guildId:t,disableStatus:u}],m)=>{var r,l;let i;o!=null&&o.avatar&&(i=(l=(r=o==null?void 0:o.getAvatarURL)==null?void 0:r.call(o,!1,4096,!0))==null?void 0:l.replace(".webp",".png"));const w=`https://cdn.discordapp.com/guilds/${t}/users//${o==null?void 0:o.id}/avatars/${o==null?void 0:o.guildMemberAvatars[t]}.png?size=4096`;return u||!i&&(o==null?void 0:o.guildMemberAvatars[t])==null?m:(o==null?void 0:o.guildMemberAvatars[t])==null&&i?d(function(){return a.openURL(i)},m):(o==null?void 0:o.guildMemberAvatars[t])!=null&&!i?d(function(){return a.openURL(w)},m):d(function(){return g(w,i)},m)}),c.after(L,"default",(n,[o],t)=>{var u,m;if(!("style"in o))return t;const r=o.bannerSource.uri.replace(/(?:\?size=\d{3,4})?$/,"?size=4096").replace("users","users/").replace(".webp",".png");if(!((u=o.bannerSource)!=null&&u.uri))return t;const l=C.getUser((m=o.bannerSource)==null?void 0:m.uri.replace("https://","").split("/")[4]);if(r.includes("users")&&l.banner){const i=`https://cdn.discordapp.com/banners/${l.id}/${l.banner}.png?size=4096`;return d(function(){return g(r,i)},t)}return d(function(){return a.openURL(r)},t)})},onStop(){c.unpatchAll()},getSettingsPanel({settings:n}){return s.createElement(P,{settings:n})}};function d(n,o){return T("PictureLink","longPressEnabled",!1)?s.createElement(y,{onLongPress:()=>n()},o):s.createElement(y,{onPress:()=>n()},o)}function g(n,o){h.show({title:"Open...",body:"Select a profile to open.",confirmText:"Server Profile",cancelText:"Global Profile",secondaryConfirmText:"Nevermind",onConfirm:()=>{a.openURL(n)},onCancel:()=>{a.openURL(o)}})}b(R);
